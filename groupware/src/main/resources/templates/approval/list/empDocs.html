<!DOCTYPE html>
<html xmlns:th="https://www.thymeleaf.org/"
	  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	  layout:decorate="~{common/layouts/default_layout}">

<th:block layout:fragment="Content">

	<div class="container-xxl flex-grow-1 container-p-y">
	<div class="row flex-xl-nowrap">
	<div class="DocSearch-content col-12 container-p-y">
		<div class="mt-3 pt-3">
			<h2 class="m-0 p-0">문서함</h2>
			<br>
			<p> 내가 작성한 문서를 조회하는 화면입니다. (작성중, 상신완료, 반려문서 등)</p>
			<hr>
		</div>
		
		<div class="mt-3 pt-3">
			<p>로그인Id <input type="text" th:value="${#authentication.principal.empId}" name="draft" readonly />
			부서ID <input type="text" th:value="${#authentication.principal.deptId}" name="deptId" readonly />
			회사ID <input type="text" th:value="${#authentication.principal.custNo}" name="custNo" readonly />
			사원명 <input type="text" th:value="${#authentication.name}" name="draptName" readonly /></p>
			<hr>
		</div>
		
		<div>
		<!-- 검색공간 -->
		<p class="navbar-brand">검색조건</p>
		<nav class="navbar navbar-expand-lg navbar-light">
			<div class="container-fluid">
				<button class="navbar-toggler" type="button"
					data-bs-toggle="collapse"
					data-bs-target="#navbarSupportedContent"
					aria-controls="navbarSupportedContent" aria-expanded="false"
					aria-label="Toggle navigation">
					<span class="navbar-toggler-icon"></span>
				</button>
				<div class="collapse navbar-collapse" id="navbarSupportedContent">
					<table>
						<tr>
							<td><select class="form-select searchKeySelect">
									<option value="custname">제목</option>
									<option value="ctno">기안자</option>
									<option value="custno">고객번호</option>
							</select></td>
							<td colspan='3'><input class="form-control searchKey"
								type="text"></td>
							<td class="text-white">_</td>
							<td class="form-control">계약상태</td>
							<td><select class="form-select ctStat">
									<option value="statAll">전체</option>
									<option value="0A1a">계약중</option>
									<option value="0A2a">계약종료</option>
							</select></td>
						</tr>
						<tr>
							<td><select class="form-select ctDt">
									<option value="ct.ct_start_dt">계약시작일</option>
									<option value="ct.ct_end_dt">계약종료일</option>
							</select></td>
							<td><input class="form-select fromDt" type="date"></td>
							<td>~</td>
							<td><input class="form-select toDt" type="date"></td>
							<td class="text-white">_</td>
							<td class="form-control">정렬조건</td>
							<td><select class="form-select searchSelect">
									<option value="ct.ct_no">계약번호순</option>
									<option value="ct.ct_start_dt">계약시작일순</option>
									<option value="ct.ct_end_dt">계약종료일순</option>
							</select></td>
						</tr>
					</table>
					<span class="position-absolute top-50 end-0 translate-middle-y">
						<button class="btn btn-outline-success searchbtn bg-light"
							type="submit">검색</button>
					</span>
				</div>
			</div>
		</nav>				
			
		</div>
		
		<div class="mt-3 pt-3">
			<div class="table-responsive">
				<table class="table table-bordered table-hover text-center bg-white">
					<thead >
						<tr class="table-dark">
							<th class="text-white col-1">문서번호</th>
							<th>작성일자</th>
							<th>제목</th>
							<th>업무명</th>
							<th>작성상태</th>
							<th>문서상태</th>
							<th>결재상황</th>
						</tr>
					</thead>
					<tbody>
						<th:block th:each="doc : ${list}">
						<tr th:onclick="|location.href='@{/docInfo(docNo=${doc.docNo})}'|">
							<td>[[ ${doc.docNo} ]]</td>
							<td>[[ ${#dates.format(doc.draftDt, 'yyyy-MM-dd')} ]]</td>
							<td>[[ ${doc.title} ]]</td>
							<td class="taskTitle">
								<span th:text="${doc.taskCount != 0 ? doc.taskList[0].taskName : '-'}"></span>
								<span th:text="${doc.taskCount > 1 ? '외' : ''}"></span>&ensp;
								<span th:text="${doc.taskCount > 1 ? doc.taskCount - 1 : ''}"></span>
								<div class="taskList" style="display:none;">
								<th:block th:each="task : ${doc.taskList}">
									<span>[[ ${task.deptName} ]]&ensp;[[ ${task.taskName} ]]</span>
									<br>
								</th:block>
								</div>
							</td>
							<td>[[ ${doc.draftStatName} ]]</td>
							<td>[[ ${doc.docStatName} ]]</td>
							<td th:if="${doc.draftStat == '4A1a'}">-</td>
							<td th:unless="${doc.draftStat == '4A1a'}"> [[ ${doc.curApr} ]]</td>
						</tr>
						</th:block>
					</tbody>
				</table>
			</div>
			<div>
				<!-- 페이징공간 -->
				<div class="paging">
				<th:block th:if="${pageDTO.totalCnt} != 0">
					<nav aria-label="Page navigation">
						<ul class="pagination justify-content-center">

							<th:block th:if="${pageDTO.prev}">
								<li class="page-item prev"><a
									href="#"
									th:id="${pageDTO.startPage - 1 }"
									class="page-link pagebtn"><i class="bx bx-chevron-left"></i></a></li>
							</th:block>
							<th:block
								th:each="num : ${#numbers.sequence(1, pageDTO.endPage)}">
								<li class="page-item "
									th:attrappend="class=${num ==  pageDTO.page ? 'active' : ' '}">
									<a href="#"
										th:id="${num}"
										class="page-link pagebtn">[[${num}]]</a>
								</li>
							</th:block>
							<th:block th:if="${pageDTO.next}">
								<li class="page-item next"><a
									href="#"
									th:id="${pageDTO.endPage + 1 }"
									class="page-link pagebtn"><i class="bx bx-chevron-right"></i></a></li>
							</th:block>
						</ul>
					</nav>
				</th:block>
				<th:block th:unless="${pageDTO.totalCnt} != 0">
					<p>현재 등록된 계약이 없습니다.</p>
				</th:block>
			</div>
			</div>
			
		</div>
		
	</div>
	</div>
	</div>
<script th:src="@{/js/docsch.js}"></script>
<script>
	$(function(){
		
		// 나머지업무명 보이기.
		$('.taskTitle').hover(function(){
			$(this).find('.taskList').toggle();
		})
		
	})
</script>


</th:block>



</html>