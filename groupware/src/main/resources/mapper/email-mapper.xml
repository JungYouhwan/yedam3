<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
  <mapper namespace="com.samjo.app.email.mapper.EmailMapper">
 	<select id="selectInboxAll" resultType="EmailVO">
  		SELECT REC_EMAIL_NO
               ,SEN_EMAIL_NO
               ,RECP
               ,RECP_TYPE
               ,READ_DT
               ,EMAIL_STAT
               ,CUST_NO
        FROM INBOX
        <!--  WHERE RECP = #{empId} -->
  	</select>

  	<insert id="insertEmail" parameterType="EmailVO">
  		<selectKey keyProperty="senEmailNo"
  				   resultType="Integer"
  				   order="BEFORE">
  			SELECT NVL(MAX(sen_email_no),0) + 1
  			FROM email	   
  		</selectKey>
  	</insert>
  	
  	<select id="count">
  		SELECT count(*)
  		FROM INBOX
  	</select>
  	
  	<select id="selectEmailAll" resultType="EmailVO">
  		SELECT SEN_EMAIL_NO
              ,SENDER
              ,TITLE
              ,CNTN
              ,SENT_DT
              ,EMAIL_STAT
              ,CHAIN_MAIL_NO
              ,CUST_NO
        FROM EMAIL
        <!--  WHERE RECP = #{empId} -->
  	</select>
  	
  	 <select id="countSend">
  		SELECT count(*)
  		FROM EMAIL
  	</select>
  	
  	<!-- 휴지통 -->
  	<update id="goWaste">
	  	UPDATE email
		SET email_stat = '3B2b'
		WHERE sen_email_no = 
  	</update>
  	
  	 <select id="countWasted">
  		SELECT count(*)
  		FROM   EMAIL
  		WHERE  email_stat = '3B2b'
  	</select>

	<select id="wastedList" resultType="EmailVO">
  	SELECT s.sender
      	  ,s.title
          ,s.sent_dt
    FROM  email s JOIN inbox i
          ON s.sen_email_no = i.sen_email_no
    WHERE s.email_stat = '3B2b'
          AND i.email_stat = '3B2b'
	</select>
  	
  </mapper>